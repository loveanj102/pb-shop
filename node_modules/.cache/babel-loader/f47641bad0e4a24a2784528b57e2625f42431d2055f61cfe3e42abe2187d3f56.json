{"ast":null,"code":"import{useEffect,useRef,useState}from'react';import axios from'axios';import OrderModal from'../../components/OrderModal';import Pagination from'../../components/Pagination';import{Modal}from'bootstrap';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdminProducts(){const[orders,setOrders]=useState([]);// 空陣列\nconst[pagination,setPagination]=useState({});//物件內容\nconst orderModal=useRef(null);//使用useRef匯入Modal\n// Type:決定Modal展開的用途\n//此段程式碼為“編輯”商品資訊預設變數\nconst[type,setType]=useState('create');//當我點選type是'create'的時候，就表示我是要新增商品\nconst[tempOrder,setTempOrder]=useState({});//當我編輯資料，必須要帶入原本資料，需要有一個暫存欄位\nuseEffect(()=>{orderModal.current=new Modal('#productModal',{backdrop:'static'});//預設此Modal為一個新的Modal,並且backdrop click = false\ngetOrders();},[]);const getOrders=async function(){let page=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;//page=1 參數預設值，假設沒有帶入任何函數預設值就會等於1\nconst ordersRes=await axios.get(\"/v2/api/\".concat(process.env.REACT_APP_API_PATH,\"/admin/orders?page=\").concat(page));//4.遠端取得產品列表\nconsole.log(ordersRes);setOrders(ordersRes.data.orders);//取出產品相關資料，產品資料放置位置，看console.log\nsetPagination(ordersRes.data.pagination);//取出分頁相關資料\n};//以下程式碼為展開＆關閉Modal\nconst openOrderModal=(type,product)=>{setType(type);//寫入方法傳入type值\nsetTempOrder(product);// 寫入方法傳入product值\norderModal.current.show();};const closeOrderModal=()=>{orderModal.current.hide();};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-3\",children:[/*#__PURE__*/_jsx(OrderModal,{closeOrderModal:closeOrderModal,getOrders:getOrders,tempOrders:tempOrder,type:type}),\" \",/*#__PURE__*/_jsx(\"h3\",{children:\"\\u7522\\u54C1\\u5217\\u8868\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-end\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u8A02\\u55AE id\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u8CFC\\u8CB7\\u7528\\u6236\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u8A02\\u55AE\\u91D1\\u984D\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u4ED8\\u6B3E\\u72C0\\u614B\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u4ED8\\u6B3E\\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u7559\\u8A00\\u8A0A\\u606F\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u7DE8\\u8F2F\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(order=>{var _order$user,_order$user2;//找的時候用products複數意旨全部產品，取出帶入值使用product單筆取出\nreturn/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order.id}),/*#__PURE__*/_jsxs(\"td\",{children:[(_order$user=order.user)===null||_order$user===void 0?void 0:_order$user.name,(_order$user2=order.user)===null||_order$user2===void 0?void 0:_order$user2.email]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.total]}),/*#__PURE__*/_jsx(\"td\",{children:order.is_paid?/*#__PURE__*/_jsx(\"span\",{className:\"text-success fw-bold\",children:\"\\u4ED8\\u6B3E\\u5B8C\\u6210\"}):'未付款'}),/*#__PURE__*/_jsx(\"td\",{children:order.paid_date?new Date(order.paid_date*1000).toLocaleString():'未付款'}),/*#__PURE__*/_jsx(\"td\",{children:order.message}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary btn-sm\",onClick:()=>{openOrderModal(order);},children:\"\\u67E5\\u770B\"})})]},order.id);})})]}),/*#__PURE__*/_jsx(Pagination,{pagination:pagination,changePage:getOrders})]});}export default AdminProducts;","map":{"version":3,"names":["useEffect","useRef","useState","axios","OrderModal","Pagination","Modal","jsx","_jsx","jsxs","_jsxs","AdminProducts","orders","setOrders","pagination","setPagination","orderModal","type","setType","tempOrder","setTempOrder","current","backdrop","getOrders","page","arguments","length","undefined","ordersRes","get","concat","process","env","REACT_APP_API_PATH","console","log","data","openOrderModal","product","show","closeOrderModal","hide","className","children","tempOrders","scope","map","order","_order$user","_order$user2","id","user","name","email","total","is_paid","paid_date","Date","toLocaleString","message","onClick","changePage"],"sources":["/Users/nikki.kang/Desktop/Nikki/website/pb-shop/src/pages/admin/AdminOrderList.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport axios from 'axios';\nimport OrderModal from '../../components/OrderModal'\nimport Pagination from '../../components/Pagination';\nimport { Modal } from 'bootstrap';\n\nfunction AdminProducts() {\n    const [orders, setOrders] = useState([]); // 空陣列\n    const [pagination, setPagination] = useState({}); //物件內容\n    const orderModal = useRef(null); //使用useRef匯入Modal\n\n    // Type:決定Modal展開的用途\n    //此段程式碼為“編輯”商品資訊預設變數\n    const [type, setType] = useState('create'); //當我點選type是'create'的時候，就表示我是要新增商品\n    const [tempOrder, setTempOrder] = useState({}); //當我編輯資料，必須要帶入原本資料，需要有一個暫存欄位\n\n\n    useEffect(() => {\n        orderModal.current = new Modal('#productModal', { backdrop: 'static', }); //預設此Modal為一個新的Modal,並且backdrop click = false\n        getOrders();\n    }, []);\n\n    const getOrders = async (page = 1) => { //page=1 參數預設值，假設沒有帶入任何函數預設值就會等於1\n        const ordersRes = await axios.get(`/v2/api/${process.env.REACT_APP_API_PATH}/admin/orders?page=${page}`); //4.遠端取得產品列表\n        console.log(ordersRes);\n        setOrders(ordersRes.data.orders); //取出產品相關資料，產品資料放置位置，看console.log\n        setPagination(ordersRes.data.pagination); //取出分頁相關資料\n    }\n    //以下程式碼為展開＆關閉Modal\n    const openOrderModal = (type, product) => {\n        setType(type); //寫入方法傳入type值\n        setTempOrder(product); // 寫入方法傳入product值\n        orderModal.current.show();\n    }\n\n    const closeOrderModal = () => {\n        orderModal.current.hide();\n    }\n\n\n    return (\n        <div className=\"p-3\">\n            <OrderModal\n                closeOrderModal={closeOrderModal}\n                getOrders={getOrders}\n                tempOrders={tempOrder}\n                type={type} /> {/*透過props的方法傳送給元件*/}\n\n            <h3>產品列表</h3>\n            <hr />\n            <div className=\"text-end\">\n            </div>\n            <table className=\"table\">\n                <thead>\n                    <tr>\n                        <th scope='col'>訂單 id</th>\n                        <th scope='col'>購買用戶</th>\n                        <th scope='col'>訂單金額</th>\n                        <th scope='col'>付款狀態</th>\n                        <th scope='col'>付款日期</th>\n                        <th scope='col'>留言訊息</th>\n                        <th scope='col'>編輯</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {orders.map((order) => { //找的時候用products複數意旨全部產品，取出帶入值使用product單筆取出\n                        return (\n                            <tr key={order.id}>\n                                <td>{order.id}</td>\n                                <td>\n                                    {order.user?.name}\n                                    {order.user?.email}\n                                </td>\n                                <td>${order.total}</td>\n                                <td>\n                                    {order.is_paid ? (\n                                        <span className='text-success fw-bold'>付款完成</span>\n                                    ) : (\n                                        '未付款'\n                                    )}\n                                </td>\n                                <td>\n                                    {order.paid_date\n                                        ? new Date(order.paid_date * 1000).toLocaleString()\n                                        : '未付款'}\n                                </td>\n                                <td>{order.message}</td>\n\n                                <td>\n                                    <button\n                                        type='button'\n                                        className='btn btn-primary btn-sm'\n                                        onClick={() => {\n                                            openOrderModal(order);\n                                        }}\n                                    >\n                                        查看\n                                    </button>\n                                </td>\n                            </tr>\n                        )\n                    })}\n\n                </tbody>\n            </table>\n\n            <Pagination pagination={pagination} changePage={getOrders} />\n        </div>\n    )\n}\n\nexport default AdminProducts;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}